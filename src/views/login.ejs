<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>List Users</title>
    <!-- Latest compiled and minified CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Option 1: Include in HTML -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css"
    />

    <!-- Latest compiled JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  </head>

  <style>
    .bi-google{
      font-size: 30px;
      color: aqua;
      cursor: pointer;
      padding: 0 15px;
    }
    .bi-facebook{
      font-size: 30px;
      color: blue;
      cursor: pointer;
      padding: 0 15px;
    }
    .flash{
      display: none;
    }
  </style>

  <script>
   $(document).ready(function () {
    $('#btnLogin').on('click', function(){
      const username = $('#username').val();
      const password = $('#password').val();
      $('#flashMsg').empty('');
      $.ajax({
        type: 'POST',
        url: `${window.location.origin}/login`,
        data: { username, password },
        cache: false,
        xhrFields: {
          withCredentials: true
        },
        success: function(data){  
          console.log(">>>>>: ",data)
          $('#flashMsg').addClass('flash')
          window.location.href = '/';
        },
        error: function(request, status, error){
          $('#password').val("");
          $('#flashMsg').removeClass('flash')
          $('#flashMsg').append(request.responseText)
        }
      })
    })
   })
  </script>

  <body>
    <!-- Pills content -->
    <div class="tab-content">
      <div
        class="tab-pane fade show active"
        id="pills-login"
        role="tabpanel"
        aria-labelledby="tab-login"
      >
      <form>
        <div class="col-6 mx-auto mt-4">
          <fieldset class="border rounded-3 p-3">
            <legend class="float-none w-auto px-3">Login Form:</legend>
  
              <div class="alert alert-danger my-3 flash" role="alert" id="flashMsg">

              </div>
            
            <!-- Email input -->
            <div class="form-outline mb-4">

              <label class="form-label" for="loginName"
                >Username</label
              >
              <div class="input-group has-validation">
                <input 
                type="text"         
                class="form-control"
                name="username"
                id="username"
                />
                <div class="invalid-feedback">
                  Please choose a username.
                </div>
              </div>
            </div>

            <!-- Password input -->
            <div class="form-outline mb-4">
              <label class="form-label" for="loginPassword">Password</label>
              <div class="input-group has-validation">
                <input type="password" name="password" id="password" class="form-control" autocomplete="on"/>
                <div class="invalid-feedback">
                  Please choose a username.
                </div>
              </div>
            </div>

            <!-- Submit button -->
            <button type="button" id="btnLogin" class="btn btn-primary btn-block mb-4">
              Sign in 
            </button>
            <hr />
            <div>
              <div class="text-center">
                <span>Or login with:</span>
              </div>
              <div class="social text-center">
                <i class="bi bi-google"></i>
                <i class="bi bi-facebook"></i>
              </div>
            </div>
          </fieldset>
        </div>
      </form>
          
      </div>
  </body>
</html>
